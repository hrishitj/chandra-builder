<div class="main-product-page">
@if(!isSmallView()) {
    <div class="parent-container-normal">
        <div class="img-container">
            @if(imageLoaded()  && showPreview()) {
                <img [src]="braceletImages()[0]" alt="left" class="bracelet-img" />
                <!-- List of Images -->
                <ul class="list-of-img">
                    @for(image of characterImages(); track $index) {
                        <li> <img [src]="image" [alt]="image"
                                [ngClass]="(formGroup.value.letterHeightId | codelistPipe : letterHeights()) === 'Medium' ? 'final-img-bracelet' : 'final-img-bracelet-large'" />
                        </li>
                    }
                </ul>
                <app-measurement-scale [height]="(formGroup.value.letterHeightId | codelistPipe : letterHeights())" [width]="itemWidth()" />
            } @else {
                <app-image-slider [mediaItems]="mediaItems" [themeColor]="themeColor()"></app-image-slider>
            }
        </div>

        <div [formGroup]="formGroup" class="form-container">
            <h2>{{(formGroup.controls.metalColorId.value | codelistPipe : metalColors())}} Customized Diamond Bracelet</h2>
            <div class="price-section"><span>${{itemPrice()}}</span></div>

            <div class="form-group">
                <label for="customName">Enter your text</label>
                <div class="row" [style.--theme-color]="formGroup.invalid ? '#ccc' : themeColor()">
                    <input type="text" id="customName" formControlName="customName" class="input-field"
                        [attr.placeholder]="(10 - (formGroup.get('customName')?.value?.length || 0)) + ' characters remaining'"
                        maxlength="10" style="text-transform: uppercase;" />
                    <button class="preview-button" [matTooltip]="formGroup.invalid ? 'Enter name to preview' : null"
                        [class.enabled-preview]="!formGroup.invalid"
                        [disabled]="formGroup.invalid" type="button" (click)="onPreviewClick()">
                        Preview
                        <mat-icon>{{ showPreview() ? 'visibility_off' : 'visibility' }}</mat-icon>
                    </button>
                </div>
            </div>


            <!-- Metal Color -->
            <div class="form-group">
                <label>Choose your color</label>
                <div class="options-group">
                    @for(color of metalColors(); track color.id) {
                    <app-text-with-image-button [themeColor]="themeColor()" [imageSource]="color.icon"
                        [isSelected]="formGroup.get('metalColorId')?.value === color.id"
                        (clicked)="selectOption('metalColorId', color.id)"></app-text-with-image-button>
                    }
                </div>
            </div>

            <!-- Metal Carat -->
            <div class="form-group">
                <label>Select carat</label>
                <div class="options-group">
                    @for(carat of metalKarats(); track carat.id) {
                        <button type="button"
                            (click)="selectOption('metalCaratId', carat.id)"
                            [class.active]="formGroup.get('metalCaratId')?.value === carat.id"
                            class="option">
                            {{ carat.name }}
                        </button>
                    }
                </div>
            </div>

            <div class="form-group-sub-container">
                <div class="form-group-row">
                    <!-- Quantity -->
                    <div class="form-group" style="display: flex; flex-direction: column;">
                        <label for="quantity">Quantity</label>
                        <input type="number" id="quantity" formControlName="quantity" class="quantity-input"
                            placeholder="Enter quantity" />
                        <div class="error-message" *ngIf="formGroup.get('quantity')?.errors?.['min']">
                            * Please enter a valid quantity greater than 0.
                        </div>
                    </div>

                    <!-- Font Style -->
                    <div class="form-group">
                        <label>Font Style</label>
                        <div class="options-group">
                            @for(font of fontStyles(); track font.id) {
                                <button type="button"
                                    (click)="selectOption('fontStyleId', font.id)"
                                    [class.active]="formGroup.get('fontStyleId')?.value === font.id" class="height-option">
                                    {{ font.name }}
                                </button>
                            }
                        </div>
                    </div>
                </div>


                <div class="form-group-row">
                    <!-- Diamond Quality -->
                    <div class="form-group">
                        <label>Diamond Quality</label>
                        <div class="options-group">
                            @for(quality of diamondQualities(); track quality.id) {
                                <button type="button"
                                    (click)="selectOption('diamondQualityId', quality.id)"
                                    [class.active]="formGroup.get('diamondQualityId')?.value === quality.id" class="height-option">
                                    {{ quality.name }}
                                </button>
                            }
                        </div>
                    </div>

                    <!-- Letter Height -->
                    <!-- <div class="form-group">
                        <label>Letter Height</label>
                        <div class="options-group">
                            @for(height of letterHeights(); track height.id) {
                                <button type="button"
                                    (click)="selectOption('letterHeightId', height.id)"
                                    [class.active]="formGroup.get('letterHeightId')?.value === height.id" class="height-option">
                                    {{ height.name }}
                                </button>
                            }
                        </div>
                    </div> -->
                </div>
            </div>

            <!-- Submit Button -->
            <div class="form-group" [style.--theme-color]="formGroup.invalid ? '#ccc' : themeColor()">
                <div class="cta-buttons">
                    <button type="submit" [disabled]="formGroup.invalid" class="submit-button primary"
                        (click)="buyAction('BUY_NOW')">
                        BUY NOW
                    </button>
                    <button type="submit" [disabled]="formGroup.invalid" class="submit-button secondary"
                        (click)="buyAction('ADD_TO_CART')">
                        ADD TO CART
                    </button>
                </div>
            </div>
        </div>
    </div>
}
@else {
    <div class="parent-container-small">
        <div class="img-container">
            @if(imageLoaded()  && showPreview()) {
                <img [src]="braceletImages()[0]" alt="left" class="bracelet-img" />
                <!-- List of Images -->
                <ul class="list-of-img">
                    @for(image of characterImages(); track $index) {
                        <li> <img [src]="image" [alt]="image"
                                [ngClass]="(formGroup.value.letterHeightId | codelistPipe : letterHeights()) === 'Medium' ? 'final-img-bracelet' : 'final-img-bracelet-large'" />
                        </li>
                    }
                </ul>
                <app-measurement-scale [height]="(formGroup.value.letterHeightId | codelistPipe : letterHeights())" [width]="itemWidth()" />
            } @else {
                <app-image-slider [mediaItems]="mediaItems" [themeColor]="themeColor()"></app-image-slider>
            }
        </div>

        <div [formGroup]="formGroup" class="form-container">
            <h2>{{(formGroup.controls.metalColorId.value | codelistPipe : metalColors())}} Customized Diamond Bracelet</h2>
            <div class="price-section"><span>${{itemPrice()}}</span></div>

            <div class="form-group">
                <label for="customName">Enter your text</label>
                <div class="row" [style.--theme-color]="formGroup.invalid ? '#ccc' : themeColor()">
                    <input type="text" id="customName" formControlName="customName" class="input-field"
                        [attr.placeholder]="(10 - (formGroup.get('customName')?.value?.length || 0)) + ' characters remaining'"
                        maxlength="10" style="text-transform: uppercase;" />
                    <button class="preview-button" [matTooltip]="formGroup.invalid ? 'Enter name to preview' : null"
                        [class.enabled-preview]="!formGroup.invalid"
                        [disabled]="formGroup.invalid" type="button" (click)="onPreviewClick()">
                        Preview
                        <mat-icon>{{ showPreview() ? 'visibility_off' : 'visibility' }}</mat-icon>
                    </button>
                </div>
            </div>


            <!-- Metal Color -->
            <div class="form-group">
                <label>Choose your color</label>
                <div class="options-group">
                    @for(color of metalColors(); track $index) {
                    <app-text-with-image-button [themeColor]="themeColor()" [imageSource]="color.icon"
                        [isSelected]="formGroup.get('metalColorId')?.value === color.id"
                        (clicked)="selectOption('metalColorId', color.id)"></app-text-with-image-button>
                    }
                </div>
            </div>

            <!-- Metal Carat -->
            <div class="form-group">
                <label>Select carat</label>
                <div class="options-group">
                    @for(carat of metalKarats(); track carat) {
                        <button type="button"
                            (click)="selectOption('metalCaratId', carat.id)"
                            [class.active]="formGroup.get('metalCaratId')?.value === carat.id"
                            class="option">
                            {{ carat.name }}
                        </button>
                    }
                </div>
            </div>

            <div class="form-group-sub-container">
                <div class="form-group-row">
                    <!-- Quantity -->
                    <div class="form-group" style="display: flex; flex-direction: column;">
                        <label for="quantity">Quantity</label>
                        <input type="number" id="quantity" formControlName="quantity" class="quantity-input"
                            placeholder="Enter quantity" />
                        <div class="error-message" *ngIf="formGroup.get('quantity')?.errors?.['min']">
                            * Please enter a valid quantity greater than 0.
                        </div>
                    </div>

                    <!-- Font Style -->
                    <div class="form-group">
                        <label>Font Style</label>
                        <div class="options-group">
                            @for(font of fontStyles(); track font) {
                                <button type="button"
                                    (click)="selectOption('fontStyleId', font.id)"
                                    [class.active]="formGroup.get('fontStyleId')?.value === font.id" class="height-option">
                                    {{ font.name }}
                                </button>
                            }
                        </div>
                    </div>
                </div>


                <div class="form-group-row">
                    <!-- Diamond Quality -->
                    <div class="form-group">
                        <label>Diamond Quality</label>
                        <div class="options-group">
                            @for(quality of diamondQualities(); track quality.id) {
                                <button type="button"
                                    (click)="selectOption('diamondQualityId', quality.id)"
                                    [class.active]="formGroup.get('diamondQualityId')?.value === quality.id" class="height-option">
                                    {{ quality.name }}
                                </button>
                            }
                        </div>
                    </div>

                    <!-- Letter Height -->
                    <!-- <div class="form-group">
                        <label>Letter Height</label>
                        <div class="options-group">
                            @for(height of letterHeights(); track height.id) {
                                <button type="button"
                                    (click)="selectOption('letterHeightId', height.id)"
                                    [class.active]="formGroup.get('letterHeightId')?.value === height.id" class="height-option">
                                    {{ height.name }}
                                </button>
                            }
                        </div>
                    </div> -->
                </div>
            </div>

            <!-- Submit Button -->
            <div class="form-group" [style.--theme-color]="formGroup.invalid ? '#ccc' : themeColor()">
                <div class="cta-buttons">
                    <button type="submit" [disabled]="formGroup.invalid" class="submit-button primary"
                        (click)="buyAction('BUY_NOW')">
                        BUY NOW
                    </button>
                    <button type="submit" [disabled]="formGroup.invalid" class="submit-button secondary"
                        (click)="buyAction('ADD_TO_CART')">
                        ADD TO CART
                    </button>
                </div>
            </div>
        </div>
    </div>
}
    <div class="product-section">
        <div class="product-header" (click)="toggleDescription()">
            <span>Product Description</span>
            <span class="toggle-icon">{{ isDescriptionVisible ? '-' : '+' }}</span>
        </div>
        <div class="product-description" *ngIf="isDescriptionVisible">
            <p>
                Wear your identity with a custom diamond name bracelet. Choose from 10kt, 14kt, or 18kt Yellow, White, or Rose Gold. Select your diamond clarity (VS, SI, or Lab-Grown) and font style (Regular or Sporty). Available in Small (7.6mm uppercase) or Large (8.9mm uppercase) lettering. Handcrafted with a 7.5-inch cable chain, this bracelet is a unique expression of you.
            </p>
        </div>

        <div class="product-header" (click)="toggleDetails()">
            <span>Product Details</span>
            <span class="toggle-icon">{{ isDetailsVisible ? '-' : '+' }}</span>
        </div>
        @if(isDetailsVisible) {
        <div class="product-details" [class.mobile]="isSmallView()">
            <div>
                <div class="section-header">Metal Information:</div>
                <ul>
                    <li>Karat: {{(formValue.metalCaratId | codelistPipe : metalKarats()) ?? ''}}</li>
                    <li>Color: {{(formValue.metalColorId | codelistPipe : metalColors()) ?? ''}}</li>
                </ul>
            </div>
            <div>
                <div class="section-header">Diamond Information:</div>
                <ul>
                    <li>Number of Diamonds: {{noOfDiamonds()}} </li>
                    <li>Shape: Round</li>
                    <li>Carat Weight: {{caratWeight().toFixed(2)}} </li>
                </ul>
            </div>
            <div>
                <div class="section-header">Additional Information:</div>
                <ul>
                    <li>Total Diamond Weight (Approx.):{{caratWeight().toFixed(2)}}</li>
                    <li>Chain Type / Length: Cat 30 Cable Chain with Lobster Lock / 18 INCH</li>
                    <li>Design Width (Approx.): {{itemWidth()}} </li>
                </ul>
            </div>
        </div>
        }
    </div>
    <app-faq-section></app-faq-section>
</div>